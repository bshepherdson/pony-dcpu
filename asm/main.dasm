; Test routine that runs inside my budding OS.

.equ int_timer, 1

:main
; Set up the timer interrupt.
set a, int_timer
set b, handler_timer
jsr set_interrupt_for

set b, int_timer
set a, 2
hwi [hw_clock]

set b, 30
set a, 0
hwi [hw_clock]

sub pc, 1

:clock_ticks dat 0


:handler_timer
set push, b
set push, c
set a, 0
set b, 0
jsr move_cursor

set a, [clock_ticks]
add a, 1
set [clock_ticks], a
jsr print_uint

set c, pop
set b, pop
rfi 0

