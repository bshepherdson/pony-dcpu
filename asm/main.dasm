; Test routine that runs inside my budding OS.

.equ int_keyboard, 1

:main
; Set up the keyboard interrupt.
set a, int_keyboard
set b, handler_keyboard
jsr set_interrupt_for

set b, int_keyboard
set a, 3
hwi [hw_keyboard]

sub pc, 1


:handler_keyboard
set push, b
set push, c
set a, 1
hwi [hw_keyboard]

; C is now the last character typed.
; Emit it back.
set a, c
jsr emit
set c, pop
set b, pop
rfi 0
